<!DOCTYPE html>
<html>
    <head>
      <meta charset="UTF-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="stylesheet" href="../css/beaurify.css">
      <link 
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" 
        rel="stylesheet" 
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" 
        crossorigin="anonymous">
      <link rel="stylesheet" 
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" 
      />
      <script 
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" 
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" 
        crossorigin="anonymous">
      </script>
      
      <title>Calibration Record</title>
    </head>
    <body>

      <div class="container-fluid">
        <div class="row d-flex justify-content-center">
          <div class="card border-success my-5" style="max-width: 35rem;">
            <div id="cardHeader" class="card-header bg-transparent border-success text-center">Calibration Notice</div>
    
    
            <div class="card-body text-success">
              <h5 id="calName" class="card-title text-center"></h5>

              <div class="d-flex align-items-center">
                <div class="col-11">Calibration Last Date:<span id="lastCalDate"></span></div>
                <div class="p-2 col-1"><i class="fa-duotone fa-solid fa-2x fa-pen-to-square"></i></div>
              </div>

              <div class="d-flex align-items-center">
                <div class="col-11">Calibration Due Date:<span id="dueCalDate"></span></div>
                <div class="p-2 col-1"><i class="fa-duotone fa-solid fa-2x fa-pen-to-square"></i></div>
              </div>

              <div class="d-flex align-items-center">
                <div class="col-11"><span id="calExtended">calibrationExtended</span></div>
                <div class="p-2 col-1"><i class="fa-duotone fa-solid fa-2x fa-pen-to-square"></i></div>
              </div>

              <div class="d-flex align-items-center">
                <div class="col-11"><span id="maxCalExtenstion">maxCalibrationExtension</span></div>
                <div class="p-2 col-1"><i class="fa-duotone fa-solid fa-2x fa-pen-to-square"></i></div>
              </div>

              <div class="d-flex align-items-center">
                <div class="col-11"><span id="calRangePercent">calibrationRangePercent</span></div>
                <div class="p-2 col-1"><i class="fa-duotone fa-solid fa-2x fa-pen-to-square"></i></div>
              </div>

              <div class="d-flex align-items-center">
                <div class="col-11"><span id="calAdjustmentMade">AdjustmentMade</span></div>
                <div class="p-2 col-1"><i class="fa-duotone fa-solid fa-2x fa-pen-to-square"></i></div>
              </div>
              
            
            </div>
    
    
            <div class="card-footer bg-transparent border-success text-center">
              <div class="container">
                <div class="row m-2">
                    <div class="form-group col text-center">                           
                        <button type="submit" class="btn btn-primary">Submit</button>
                        <a href="../index.html" class="btn btn-dark">Back</a>
                    </div>
                    
                </div>                    
            </div>
            </div>
          </div>
        </div>
      </div>
  

    </body>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"
      integrity="sha512-bZS47S7sPOxkjU/4Bt0zrhEtWx0y0CRkhEp8IckzK+ltifIIE9EMIMTuT/mEzoIMewUINruDBIR/jJnbguonqQ=="
      crossorigin="anonymous"></script>    
    </script>

    <script src="../libs/moment.min.js"></script>
    <script src="../libs/moment-with-locales.min.js"></script>


    <script>
        // Get all links on the page

      const calibrationName = document.getElementById('calName');
      const lastCalibrationDate = document.getElementById('lastCalDate');
      const dueCalibrationDate = document.getElementById('dueCalDate');
        
      const fetchCalRecordById = async () => {
        
        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);
        let id = urlParams.get('id');
        //Get a current time in unix format
        const unixTimestamp = moment().unix();


        // fetch all data using POST API endpoints: sensors, calibrations, procedures
        await axios.get(`../api/calibrations/${id}`)
          .then((result) => {
            
            calibrationName.innerText = result.data.calibration.calibrationName;
            lastCalibrationDate.innerText = "\u00a0\u00a0\u00a0" + moment.utc(result.data.calibration.lastCalibrationDate).format('dddd, MM/DD/YYYY');
            dueCalibrationDate.innerText = "\u00a0\u00a0\u00a0" + moment.utc(result.data.calibration.dueCalibrationDate).format('dddd, MM/DD/YYYY');
            
          })
          .catch((error) => {
            //display error message if data fetch failure occurs or any other internal error detected
            console.log(error)
          });
      };

      fetchCalRecordById();
        
      
    </script>


</html>
