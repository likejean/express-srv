<!DOCTYPE html>
<html>
    <head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="stylesheet" href="../css/beaurify.css">
		<link 
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" 
			rel="stylesheet" 
			integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" 
			crossorigin="anonymous">
		<link rel="stylesheet" 
			href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" 
		/>
		<script 
			src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" 
			integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" 
			crossorigin="anonymous">
		</script>
		
		<title>User Account</title>
    </head>
	<body>
		<div class="container light-style flex-grow-1 container-p-y">

			<h1 class="user-account-title font-weight-bold py-3 mb-4">
				User Account
			</h1>
		
			<div class="card overflow-hidden my-4">
				<div class="row no-gutters row-bordered row-border-light">
					<div class="col-md-3 pt-0">
						<div class="list-group list-group-flush account-settings-links">
							<a class="list-group-item list-group-item-action" data-toggle="list" href="#account-general">General</a>
							<a class="list-group-item list-group-item-action" data-toggle="list" href="#account-avatar-change">Change avatar</a>
							<a class="list-group-item list-group-item-action" data-toggle="list" href="#account-password-change">Change password</a>
							<a class="list-group-item list-group-item-action" data-toggle="list" href="#account-info">Info</a>
							<a class="list-group-item list-group-item-action" data-toggle="list" href="#account-social-links">Social links</a>							
							<a class="list-group-item list-group-item-action" data-toggle="list" href="#account-notifications">Notifications</a>
						</div>
					</div>
					<div style="background-color: #f9f9f9;" class="col-md-9">
						<div class="tab-content">
							<div class="tab-pane fade active show" id="account-general">
								
								<div class="card-body text-center media">
									
									<div class="container-fluid">											
										
										<div class="d-flex justify-content-center align-items-center my-5">											
											<img id="avatar-image" width="250" src="https://bootdey.com/img/Content/avatar/avatar6.png" alt="Admin" class="rounded-circle p-1 bg-primary" width="110">
										</div>

										<div class="d-flex justify-content-center align-items-center my-5">
											<div class="text-center"><span id="user-profile-fullname"></span></div>
										</div>

										<div class="d-flex justify-content-center align-items-center my-5">
											<div class="text-center"><span id="userLevel"></span></div>
										</div>
										
										<!-- user ACCOUNT INFO edit form-->

										<form id="user-account-info">	
											<div id="edit-user-account-info" class="control-form-field-box form-group my-4 p-5">
												<div class="container">
													<div class="row my-3">
														<ul class="list-group list-group-flush">														
															<li class="list-group-item d-flex justify-content-center align-items-center">																
																<div class="col-6 d-none d-sm-flex mx-1 justify-content-end">First Name:</div>               
																<div id="userFirstNameWrapper" class="col-11 col-sm-5 mx-1 gutter text-start"><span class="user-notice-span" id="userFirstName"></span></div>                
																<div class="p-2 col-1"><i id="userFirstNameIcon" class="fa-solid fa-2x fa-ellipsis-vertical"></i></div>															
															</li>
															<li class="list-group-item d-flex justify-content-center align-items-center">																
																<div class="col-6 d-none d-sm-flex mx-1 justify-content-end">Last Name:</div>               
																<div id="userLastNameWrapper" class="col-11 col-sm-5 mx-1 gutter text-start"><span class="user-notice-span" id="userLastName"></span></div>                
																<div class="p-2 col-1"><i id="userLastNameIcon" class="fa-solid fa-2x fa-ellipsis-vertical"></i></div>															
															</li>
															<li class="list-group-item d-flex justify-content-center align-items-center">																
																<div class="col-6 d-none d-sm-flex mx-1 justify-content-end">Email:</div>               
																<div id="userEmailWrapper" class="col-11 col-sm-5 mx-1 gutter text-start"><span class="user-notice-span" id="userEmail"></span></div>                
																<div class="p-2 col-1"><i id="userEmailIcon" class="fa-solid fa-2x fa-ellipsis-vertical"></i></div>
															</li>
															<li class="list-group-item d-flex justify-content-center align-items-center">																
																<div class="col-6 d-none d-sm-flex mx-1 justify-content-end">Username:</div>               
																<div id="userNickNameWrapper" class="col-11 col-sm-5 mx-1 gutter text-start"><span class="user-notice-span" id="userNickName"></span></div>                
																<div class="p-2 col-1"><i id="userNickNameIcon" class="fa-solid fa-2x fa-ellipsis-vertical"></i></div>
															</li>															
															<li class="list-group-item d-flex justify-content-center align-items-center">																
																<div class="col-6 d-none d-sm-flex mx-1 justify-content-end">Age:</div>               
																<div id="userAgeWrapper" class="col-11 col-sm-5 mx-1 gutter text-start"><span class="user-notice-span" id="userAge"></span></div>                
																<div class="p-2 col-1"><i id="userAgeIcon" class="fa-solid fa-2x fa-ellipsis-vertical"></i></div>
															</li>
															<li class="list-group-item d-flex justify-content-center align-items-center">
																<div><span id="user-profile-about-yourself"></span></div>
																<div id="userAboutYourselfWrapper" class="col-11 mx-2 gutter text-center"><span class="user-notice-span" id="userAboutYourself"></span></div>                
																<div class="p-2 col-1"><i id="userAboutYourselfIcon" class="fa-solid fa-2x fa-ellipsis-vertical"></i></div>
															</li>

															<div class="d-flex align-items-center">
																<div class="col-12"><span id="inputErrorMessage"></span></div>                
															</div>

															<div class="card-footer bg-transparent text-center">
																<div class="container">
																	<div class="row d-none d-sm-flex">
																		<div class="form-group col m-2 text-center">                           
																			<button id="patch-user-info-record" type="submit" class="btn btn-primary m-2" disabled>Submit</button>								
																			
																		</div>
																	</div>
																</div>
															</div>
														</ul>
													</div>
												</div>
											</div>
										</form>
										

										<!-- AVATAR edit form -->
										<form id="user-account-avatar">											
											<div id="account-avatar-change" class="control-form-field-box form-group my-4 p-5">
												<div class="container">
													<div class="row my-3">
														<div class="col-lg-6 col-sm-12 mb-sm-4">
															<!-- image title -->
															<label for="title">Avatar Image Title</label>
															<input
																type="text"
																id="title"
																placeholder=""
																class="form-control"
																value=""
																name="title"
																aria-describedby="title#Help"									
																required
															/>
															<small id="title#Help" class="form-text text-muted">
																Please, enter new avatar title here
															</small>
														</div>
														<!-- image description -->
														<div class="col-lg-6 col-sm-12 mb-sm-4">
															<label for="description">Image Description</label>
															<input
																type="text"
																id="description"
																placeholder=""
																class="form-control"
																value=""
																name="description"
																aria-describedby="description#Help"									
																required
															/>					
															<small id="description#Help" class="form-text text-muted">
																Please, enter new image description
															</small>
														</div>
													</div>
													<div class="row">								
														<div class="col-lg-12 col-sm-12 mb-sm-2">
															<label for="avatar" class="form-label">Update image for avatar</label>										
															<input 
																class="form-control form-control-lg" 
																type="file" 
																id="avatar" 
																accept='image/*'
																name="avatar" 
																value="" 
																aria-describedby="avatar#Help"
																onchange="document.getElementById('user-profile-avatar-image').src = window.URL.createObjectURL(this.files[0]);"
																required>
															</div>
															<small id="avatar#Help" class="form-text text-muted">
																There is no restrictions on photo size
															</small>
														</div>

														<!---->
														<button 
															type="button" 
															id="user-profile-clear-avatar-button" 
															class="btn btn-secondary my-3">
																Clear Image
														</button>
														<button id="get-user-account-avatar-form-values" type="submit" class="btn btn-primary">
															Change Avatar
														</button>
													</div>													

													<div class="container">
														<p><img class="view-avatar-fit p-3" src='#' id='user-profile-avatar-image'></p>
													</div>
												</div>
											</div>

										</form>

										<!--PASSWORD edit form -->
										<form id="user-account-password">											
											<div id="account-password-change" class="control-form-field-box form-group my-5 mx-2 p-5">
												<div class="container">
													<div class="row my-1">
														<div class="mb-4 w-50">
															<!-- Old Password -->
															<label for="oldPassword">Old Password:</label>
															<input
																name="oldPassword"
																type="password"
																class="form-control"
																id="oldPassword"
																aria-describedby="oldPassword#Help"
																placeholder=""
																required
															/>
															<small id="oldPassword#Help" class="form-text text-muted">
																Please, enter your old password here
															</small>
														</div>				
														<div class="mb-4 w-50">
															<!-- New Password -->
															<label for="newPassword">New Password:</label>
															<input
																name="newPassword"
																type="password"
																class="form-control"
																id="newPassword"
																aria-describedby="newPassword#Help"
																placeholder=""
																required
															/>
															<small id="newPassword#Help" class="form-text text-muted">
																Please, enter your new password here
															</small>
														</div>														
														<div>
															<button id="get-user-account-password-form-values" type="submit" class="btn btn-primary">
																Change Password
															</button>
														</div>
													</div>
												</div>
											</div>
										</form>

									</div>									
								</div>								
							
							<hr class="border-light m-0">
				
							<div class="card-body">
								<div class="row">
									<p class="username-item"></p>
								</div>
							</div>			
						</div>						
					</div>
				</div>
			</div>
			
			
			<div class="row d-none d-sm-flex">
				<div class="form-group col m-2 text-center">	
					<button type="button" class="btn btn-primary">Save</button>&nbsp;
					<button type="button" class="btn btn-secondary md-btn-flat" onclick="resetUserProfile()">Reset</button>
					<a href="../../index.html" class="btn btn-dark">Back</a>
				</div>
			</div>
		
		</div>
		
	</body>
    

	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"
		integrity="sha512-bZS47S7sPOxkjU/4Bt0zrhEtWx0y0CRkhEp8IckzK+ltifIIE9EMIMTuT/mEzoIMewUINruDBIR/jJnbguonqQ=="
		crossorigin="anonymous"></script>    
    </script>

	<script src="../js/classes/userGlobalFactory.js"></script>
	<script src="../js/collections/editUserProfileContainer.js"></script>
	<script src="../js/collections/newUserFormContainer.js"></script>
	<script src="../js/utils/toBase64Decoder.js"></script>
	<script src="../js/utils/attachEventListenersToIcons.js"></script>
	<script src="../js/utils/trimStringBySubstring.js"></script>
	<script src="../js/utils/removeAllChildNodes.js"></script>

	<!-- Fetch user by specific id-->
	<script src="../js/user/utils/selectUserAccountSettings.js"></script>
	<script src="../js/user/fetchUserRecordById.js"></script>
	<script src="../js/user/utils/resetUserProfileAvatarImage.js"></script>
	<script src="../js/user/utils/editUserAccountInfoChangeValueCallback.js"></script>
	<script src="../js/user/utils/editUserAccountInfoEventCallback.js"></script>

	<!-- Get new user avatar -->
	<script src="../js/user/getNewUserAvatarData.js"></script>
	<script src="../js/user/updateUserAvatarImage.js"></script>

	<!-- Get new user password -->
	<script src="../js/user/getNewUserPassword.js"></script>
	<script src="../js/user/updateUserPassword.js"></script>


	<script>
		function resetUserProfile() {
			window.location.reload();		
		}

		window.location.hash = '';  //remove hash text after # symbol
				
	</script>
	<script>

		//attach event listener to all icons in User Info flushlist for updates/edits
		let icons = document.querySelectorAll(".fa-ellipsis-vertical");
		
		attachEventListenersToIcons(icons, editUserAccountInfoClickEventCallback);		

    </script>
	

</html>